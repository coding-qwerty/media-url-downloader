@echo off
REM Setup + Run script for Media Downloader

echo.
echo === Checking for Python ===
python --version >nul 2>&1
if errorlevel 1 (
    echo Python is not found on PATH.
    echo Please install Python 3 from https://www.python.org/downloads/ and try again.
    pause
    exit /b 1
)

echo.
echo === Creating virtual environment (venv) ===
python -m venv venv
if errorlevel 1 (
    echo Failed to create virtual environment.
    pause
    exit /b 1
)

echo.
echo === Activating virtual environment ===
call venv\Scripts\activate.bat

echo.
echo === Upgrading pip ===
python -m pip install --upgrade pip

echo.
echo === Installing required libraries ===
pip install PyQt5 yt-dlp requests

echo.
echo === All dependencies installed ===
echo.

echo === Starting Media Downloader ===
python c+py.py

echo.
echo You can run it again later with:
echo   call venv\Scripts\activate.bat
echo   python c+py.py
echo.
pause
